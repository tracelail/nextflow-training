/*
 * Session 5: Basic Container Configuration
 *
 * This config enables Docker for Exercise 1
 */

// Basic process configuration
process {
    cpus = 2
    memory = '2.GB'

    // Error handling
    errorStrategy = 'retry'
    maxRetries = 2
}

// Default parameters
params {
    input = 'data/*.fastq'
    outdir = 'results'
}

// Profile configurations
profiles {
    // Docker profile for local development
    docker {
        docker.enabled = true
        docker.runOptions = '-u $(id -u):$(id -g)' // Run as current user to avoid permission issues
    }

    // Singularity profile for HPC
    singularity {
        singularity.enabled = true
        singularity.autoMounts = true
    }

    // Apptainer profile (newer name for Singularity)
    apptainer {
        apptainer.enabled = true
        apptainer.autoMounts = true
    }

    // Test profile with minimal resources
    test {
        docker.enabled = true
        docker.runOptions = '-u $(id -u):$(id -g)'

        process {
            cpus = 1
            memory = '2.GB'
        }
    }
}

// Enable reports
// report {
//     enabled = true
//     file = "${params.outdir}/reports/execution_report.html"
// }

// timeline {
//     enabled = true
//     file = "${params.outdir}/reports/timeline.html"
// }

// trace {
//     enabled = true
//     file = "${params.outdir}/reports/trace.txt"
// }