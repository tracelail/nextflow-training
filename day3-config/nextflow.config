// Parameters with defaults
params {
    input_pattern = 'data/sample*.txt'
    outdir = 'results'
}

// Process defaults
process {
    cpus = 1
    memory = '1.GB'

    // Process-specific overrides
    withLabel: 'process_low' {
        cpus = 2
        memory = '500.MB'
    }

    withLabel: 'adaptive_resources' {
        // Doubles resources on each retry
        cpus = { 1 * task.attempt}
        memory = { 1.GB * task.attempt}
    }
}

// Profiles
profiles {

    small {
        process {
            withLabel: 'process_low' {
                cpus = 1
                memory = '512.MB'
            }
        }
    }

    large {
        process {
            withLabel: 'process_low' {
                cpus = 4
                memory = '2.GB'
            }
        }
    }

    docker {
        docker.enabled = true
        docker.runOptions = '-u $(id -u):$(id -g)'
    }
}